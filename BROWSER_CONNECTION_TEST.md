# 浏览器连接功能测试指南

## 🧪 Chrome启动延迟场景测试

### 测试目的
验证新的智能浏览器连接检测功能，确保用户在启动Chrome后能够自动检测到连接状态变化。

### 测试场景

#### 场景1: 正常Chrome启动流程
1. **启动应用**: 运行 `npm run dev:tauri`
2. **查看浏览器配置**: 进入Dashboard，查看"浏览器连接配置"卡片
3. **检查初始状态**: 应该显示"未连接"状态（🔴）
4. **复制启动命令**: 点击"复制命令"按钮
5. **运行Chrome命令**: 在命令行中粘贴并运行命令
6. **观察自动检测**: 
   - 应该在3秒后自动开始检测
   - 状态变为"Chrome启动中..."（🟡）
   - 显示进度条和计数器 (x/15)
   - 预计等待时间倒计时

#### 场景2: 快速连接成功
**期待结果**: 
- 5-10秒内状态变为"已连接"（🟢）
- 显示成功消息弹窗
- 自动停止监控

#### 场景3: 延迟连接成功
**模拟条件**: Chrome启动较慢的情况
**期待结果**:
- 显示启动进度条
- 超过10次检测时显示延迟提示
- 最终连接成功并显示成功状态

#### 场景4: 超时处理
**模拟条件**: Chrome启动失败或端口被占用
**期待结果**:
- 15次检测后（30秒）自动超时
- 状态恢复为"未连接"
- 显示故障排除建议

#### 场景5: 用户取消等待
**测试步骤**:
1. 在"Chrome启动中"状态时点击"取消等待"按钮
2. 应该立即停止监控
3. 状态恢复为"未连接"

### 🔍 关键验证点

#### 自动检测机制
- [ ] 浏览器配置卡片显示时自动触发初始检测
- [ ] 复制命令后3秒开始自动监控
- [ ] 每2秒检测一次连接状态
- [ ] 连接成功后自动停止监控

#### 状态映射准确性
- [ ] `"disconnected"` → 🔴 未连接
- [ ] `"checking"` → 🟡 检查中...
- [ ] `"starting"` → 🟡 Chrome启动中...
- [ ] `"connected"` → 🟢 已连接

#### 用户界面反馈
- [ ] 启动进度条正确显示 (0-100%)
- [ ] 计数器准确显示 (x/15)
- [ ] 预计等待时间倒计时正确
- [ ] 成功连接时显示庆祝消息
- [ ] 延迟时显示故障排除提示

#### 容错处理
- [ ] 网络错误时正确处理
- [ ] 超时后自动恢复
- [ ] 用户取消时立即停止
- [ ] 页面刷新后状态重置

### 🐛 已知问题和解决方案

#### 问题1: Chrome启动但端口未就绪
**现象**: 看到"Chrome启动中..."状态持续较长时间
**解决**: 
- 检查端口9222是否被其他程序占用
- 确认Chrome命令行参数正确
- 尝试手动关闭Chrome进程后重新启动

#### 问题2: 自动检测不工作
**现象**: 复制命令后没有自动开始检测
**解决**:
- 检查浏览器控制台是否有错误日志
- 确认Tauri环境正确初始化
- 手动点击"检查连接"按钮

### 📋 测试报告模板

```
## 浏览器连接功能测试报告

**测试环境**:
- 操作系统: Windows 11
- Chrome版本: xxx
- 应用版本: 1.0.0

**场景1: 正常启动流程**
- [ ] 初始状态正确 ✓/✗
- [ ] 复制命令功能正常 ✓/✗  
- [ ] 自动检测启动 ✓/✗
- [ ] 状态变化正确 ✓/✗
- [ ] 连接成功显示 ✓/✗

**场景2-5**: (类似填写)

**发现问题**:
1. ...
2. ...

**改进建议**:
1. ...
2. ...
```

### 💡 测试技巧

1. **并发测试**: 可以开启多个应用实例测试不同场景
2. **日志监控**: 查看浏览器控制台和Tauri日志输出
3. **网络模拟**: 可以临时禁用网络测试离线场景
4. **进程监控**: 使用任务管理器监控Chrome进程状态

---

**测试完成后请在GitHub Issues中报告结果和发现的问题**